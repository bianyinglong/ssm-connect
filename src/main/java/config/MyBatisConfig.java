package config;import com.github.pagehelper.PageHelper;import com.github.pagehelper.PageInterceptor;import org.apache.ibatis.logging.log4j.Log4jImpl;import org.apache.ibatis.plugin.Interceptor;import org.apache.ibatis.session.Configuration;import org.mybatis.spring.SqlSessionFactoryBean;import org.mybatis.spring.mapper.MapperScannerConfigurer;import org.springframework.context.annotation.Bean;import org.springframework.core.io.support.PathMatchingResourcePatternResolver;import javax.sql.DataSource;import java.io.IOException;import java.util.Properties;public class MyBatisConfig {    /**     * ä¸‹é¢ä¸¤ä¸ªæ–¹æ³•ç›¸å½“äºspring.xmlä¸­çš„å¦‚ä¸‹é…ç½®     * mybatisé…ç½®     * <bean class="org.mybatis.spring.SqlSessionFactoryBean" id="sqlSessionFactory">     * <property name="dataSource" ref="dataSource"/>     * <property name="mapperLocations" value="classpath:mapper/*.xml"/>     * </bean>     * è‡ªåŠ¨æ‰«æmapperæ¥å£     * <bean class="org.mybatis.spring.mapper.MapperScannerConfigurer">     * <property name="basePackage" value="com.lin.mapper"/>     * </bean>     */    @Bean    public PageHelper pageHelper() {        PageHelper pageHelper = new PageHelper();        Properties p = new Properties();        //è®¾ç½®ä¸ºtrueæ—¶ï¼Œä¼šå°†RowBoundsç¬¬ä¸€ä¸ªå‚æ•°offsetå½“æˆpageNumé¡µç ä½¿ç”¨        p.setProperty("offsetAsPageNum", "true");        //è®¾ç½®ä¸ºtrueæ—¶ï¼Œä½¿ç”¨RowBoundsåˆ†é¡µä¼šè¿›è¡ŒcountæŸ¥è¯¢        p.setProperty("rowBoundsWithCount", "true");        p.setProperty("reasonable", "true");        pageHelper.setProperties(p);        return pageHelper;    }    // DataSource dataSource æ¥è‡ªäºiocå®¹å™¨    @Bean    public SqlSessionFactoryBean getSqlSessionFactoryBean(DataSource dataSource) throws IOException {        SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean();        factoryBean.setDataSource(dataSource);        PathMatchingResourcePatternResolver resolve = new PathMatchingResourcePatternResolver();        // 1.åŠ è½½mapper.xmlæ–‡ä»¶        // ä½¿ç”¨classpath:è¡¨ç¤ºä»ç±»è·¯å¾„æŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚mavenå·¥ç¨‹ä¸­çš„src/main/resources        // ğŸ“¢ï¼šæ˜¯getResourcesï¼Œåˆ«æ¼æ‰äº†s        factoryBean.setMapperLocations(resolve.getResources("classpath:**/mapper/*.xml"));        // setTypeAliasesPackageè‡ªåŠ¨è®¾ç½®åˆ«åï¼ˆæš‚ä¸éœ€è¦ï¼‰ï¼Œè¿™æ · parameterType="com.guigu.mybatis.pojo.DeptExample" å¯ä»¥ç›´æ¥ç®€å†™ä¸ºDeptExample        factoryBean.setTypeAliasesPackage("com.guigu.mybatis.pojo");        // é…ç½®log4j        Configuration configuration = new Configuration();        configuration.setLogImpl(Log4jImpl.class);        factoryBean.setConfiguration(configuration);        // é…ç½®åˆ†é¡µæ’ä»¶        PageInterceptor pageInterceptor = new PageInterceptor();        // è¦ä¸ºpageInterceptorè®¾ç½®propertiesï¼Œå¦åˆ™ä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸        Properties properties = new Properties();        pageInterceptor.setProperties(properties);//        factoryBean.setPlugins(new Interceptor[]{pageInterceptor});        factoryBean.setPlugins(pageInterceptor);        return factoryBean;    }    // 2. è‡ªåŠ¨æ‰«æmapperæ¥å£    @Bean    public MapperScannerConfigurer getMapperScannerConfigurer() {        MapperScannerConfigurer mapperScannerConfigurer = new MapperScannerConfigurer();        mapperScannerConfigurer.setBasePackage("com.guigu.mapper");        return mapperScannerConfigurer;    }}